<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: September 27, 2023 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.042e26407c9e383d96a1f26d6787c686.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Reza Mehrzi"><meta name=description content="This project aims to discover hidden anomalies in data to improve system integrity by mastering anomaly detection, combined with root cause analysis."><link rel=alternate hreflang=en-us href=https://rezamehrizi.github.io/project/change-point/><link rel=canonical href=https://rezamehrizi.github.io/project/change-point/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@wowchemy"><meta property="twitter:creator" content="@wowchemy"><meta property="twitter:image" content="https://rezamehrizi.github.io/project/change-point/featured.png"><meta property="og:site_name" content="Reza Mehrizi"><meta property="og:url" content="https://rezamehrizi.github.io/project/change-point/"><meta property="og:title" content="Anomaly Detection and Root Cause Analysis | Reza Mehrizi"><meta property="og:description" content="This project aims to discover hidden anomalies in data to improve system integrity by mastering anomaly detection, combined with root cause analysis."><meta property="og:image" content="https://rezamehrizi.github.io/project/change-point/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-04-27T00:00:00+00:00"><meta property="article:modified_time" content="2023-04-27T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://rezamehrizi.github.io/project/change-point/"},"headline":"Anomaly Detection and Root Cause Analysis","image":["https://rezamehrizi.github.io/project/change-point/featured.png"],"datePublished":"2023-04-27T00:00:00Z","dateModified":"2023-04-27T00:00:00Z","author":{"@type":"Person","name":"Reza Mehrzi"},"publisher":{"@type":"Organization","name":"Reza Mehrizi","logo":{"@type":"ImageObject","url":"https://rezamehrizi.github.io/media/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"}},"description":"This project aims to discover hidden anomalies in data to improve system integrity by mastering anomaly detection, combined with root cause analysis."}</script><title>Anomaly Detection and Root Cause Analysis | Reza Mehrizi</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=7bc4a10cb372951579bb742a1324624f><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Reza Mehrizi</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Reza Mehrizi</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#skills><span>Skills</span></a></li><li class=nav-item><a class=nav-link href=/#experience><span>Experience</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#featured><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class="article article-project"><div class="article-container pt-3"><h1>Anomaly Detection and Root Cause Analysis</h1><div class=article-metadata><span class=article-date>Apr 27, 2023</span></div><div class="btn-links mb-3"><a class="btn btn-outline-primary btn-page-header" href=https://arxiv.org/abs/2009.08573 target=_blank rel=noopener><i class="fas fa-file-alt mr-1"></i>PDF (PRUTF)</a>
<a class="btn btn-outline-primary btn-page-header" href=https://arxiv.org/abs/2104.12022 target=_blank rel=noopener><i class="fas fa-file-alt mr-1"></i>PDF (Post-Detection Inference)</a></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:377px><div style=position:relative><img src=/project/change-point/featured_hu2dcd82e2e5a4a47923a9f73b8f5d7ea8_183254_720x2500_fit_q75_h2_lanczos_3.webp width=720 height=377 alt class=featured-image></div></div><div class=article-container><div class=article-style><p>Statistical analysis often involves identifying sudden changes in time series signals. In this project, I will employ the <a href=https://arxiv.org/abs/2009.08573 target=_blank rel=noopener><strong>Pattern Recovery Using Trend Filtering (PRUTF)</strong></a> anomaly detection method, which we introduced in <a href=https://arxiv.org/abs/2009.08573v1 target=_blank rel=noopener>this paper</a>. Afterward, I will discuss performing post-selection statistical inference for the anomalies estimated using PRUTF, as detailed in our <a href=https://arxiv.org/abs/2104.12022 target=_blank rel=noopener>post-selection inference paper</a>. In the following, I will provide a concise overview of the methods presented in these papers and subsequently apply them to the Coronavirus Disease (COVID-19) pandemic dataset.</p><h3 id=overview-of-prutf-and-post-selection-inference>Overview of PRUTF and Post-Selection Inference</h3><p><strong>Overview of PRUTF:</strong> The paper <a href=https://arxiv.org/abs/2009.08573 target=_blank rel=noopener>Detection of Change Points in Piecewise Polynomial Signals Using Trend Filtering</a> proposes a new methodology called Pattern Recovery Using Trend Filtering (PRUTF) for identifying unknown change points in piecewise polynomial signals with no continuity restrictions at the change point locations. The paper considers a univariate signal plus noise model, where the signal is deterministic and unknown, with equally spaced input points over the unit interval. Additionally, it is assumed that the signal undergoes unpredictable and distinct changes. With this setup, the objective of this anomaly detection analysis is to estimate the number of anomalies as well as their locations.</p><p>Our approach, PRUTF, is inspired by <a href=https://projecteuclid.org/journals/annals-of-statistics/volume-42/issue-1/Adaptive-piecewise-polynomial-estimation-via-trend-filtering/10.1214/13-AOS1189.full target=_blank rel=noopener>Tibshirani&rsquo;s method</a> but introduces a modification to accelerate the algorithm&rsquo;s implementation. PRUTF identifies change points at each regularization parameter level and removes some dual variable coordinates after each change point, ensuring independent dual variables between neighboring change points. The paper establishes a stopping criterion crucial for PRUTF&rsquo;s operation. Notably, the dual variables of trend filtering between consecutive change points form a Gaussian bridge process, allowing the introduction of a termination threshold for the algorithm. However, in cases of a staircase pattern in the signal, the method becomes statistically inconsistent. To address this, the paper proposes a modification to PRUTF, providing consistent estimates for both the number and location of change points.</p><p><strong>Overview of Post-Selection Inference for PRUTF:</strong>
The second paper, <a href=https://arxiv.org/abs/2104.12022 target=_blank rel=noopener><strong>Valid Post-Detection Inference for Change Points Identified Using Trend Filtering</strong></a>,mainly focuses on a statistical analysis of anomalies estimated by the PRUTF algorithm. It develops a methodology to perform statistical inference, such as computing p-values and constructing confidence intervals in the newly developed post-selection inference framework. Our work concerns both cases of known and unknown error variance. As pointed out in the post-selection inference literature, the length of such confidence intervals is undesirably long. To resolve this shortcoming, we are also providing two novel strategies, global post-detection and local post-detection which are based on the intrinsic properties of anomalies.</p><p>In this paper, we have made significant contributions, starting with the characterization of the set of anomalies identified by the PRUTF algorithm as a polyhedral set. This innovation facilitates post-selection inference methods for statistical analysis after anomaly detection. Additionally, we introduced a polyhedral stopping criterion for the PRUTF algorithm, derived from the Gaussian bridge property of dual variables, extending its applicability to post-detection inference. We proposed two test statistics—one for known noise variance and another for unknown noise variance—with exact and finite sample distributions under the null hypothesis. These statistics enable inference on the significance of PRUTF-identified anomalies. However, we observed that confidence intervals produced by these methods tend to be excessively wide, which can reduce the power of hypothesis tests. To address this issue, we introduced two novel conditioning methods for post-detection inference. The first method is &ldquo;local post-detection,&rdquo; which focuses solely on the target anomaly independently of others, while the second is &ldquo;global post-detection,&rdquo; emphasizing the analysis of the entire set of anomalies.</p><h3 id=application-to-the-covid-19-pandemic-dataset>Application to the Covid-19 Pandemic Dataset</h3><p>The <strong>COVID-19 pandemic</strong> has had a profound impact worldwide, straining public health systems and disrupting societies and economies. Countries around the globe had implemented various regional and national policies, such as declaring national emergencies, imposing quarantines, and conducting mass testing, in a collective effort to slow down the transmission rate. Governments were keenly interested in comprehending the dynamics of the pandemic and assessing the efficacy of these measures. This understanding can be gleaned by analyzing COVID-19 infection data. Anomaly detection serves as a valuable framework for studying the patterns in COVID-19 infection curves. By identifying the points at which these curves change significantly, anomaly analysis provides insights into shifts in transmission rates and the impact of interventions. It also enables the early detection of changes in the disease&rsquo;s behavior.</p><p>In this analysis, I focus on the log-scale of the cumulative number of confirmed cases in Canada between March 10, 2020, and April 30, 2021. Using the PRUTF method, I detected anomalies in Canada. Subsequently, I fitted a piecewise linear model to the data using these selected anomalies, offering a clearer view of how the growth rate evolved over time. The following figure illustrates the detected anomaly locations using the PRUTF algorithm, along with the estimated linear trend. The algorithm identified eight anomalies for Canada on the following dates: March 26, 2020; April 9, 2020; May 11, 2020; July 14, 2020; August 31, 2020; October 10, 2020; January 12, 2021; and March 18, 2021. The figure visualizes the segments created by these estimated anomalies and their corresponding growth rates.</p><img src=can.jpg alt="Covid-19 Pandemic Anomalies" align=center width=500><!-- ![Covid-19 Pandemic Anomalies](can.JPG) --><p>Next, in the following, I will employ the proposed post-detection inference methods to assess the significance of the anomalies estimated using PRUTF for the dataset. The following figure provides the 95 percent post-detection confidence intervals for the identified anomalies. For this Canada dataset, the polyhedron and local post-detection inference approaches reveal that the anomalies occurring on March 26, 2020; April 9, 2020; May 11, 2020; August 31, 2020; and January 12, 2021 are statistically significant.</p><img src=can_pdi.jpg alt="Post-detection Covid-19 Pandemic Anomalies" align=center width=500><!-- <img src='can_pdi.jpg' alt="OpenAI Logo" align="left" width="200"/> --><style>body{text-align:justify}</style></div><div class=article-tags><a class="badge badge-light" href=/tag/deep-learning/>Deep Learning</a>
<a class="badge badge-light" href=/tag/changepoint-detectgion/>Changepoint Detectgion</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F&amp;text=Anomaly+Detection+and+Root+Cause+Analysis" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F&amp;t=Anomaly+Detection+and+Root+Cause+Analysis" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Anomaly%20Detection%20and%20Root%20Cause%20Analysis&amp;body=https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F&amp;title=Anomaly+Detection+and+Root+Cause+Analysis" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Anomaly+Detection+and+Root+Cause+Analysis%20https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Frezamehrizi.github.io%2Fproject%2Fchange-point%2F&amp;title=Anomaly+Detection+and+Root+Cause+Analysis" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://rezamehrizi.github.io/><img class="avatar mr-3 avatar-circle" src=/authors/admin/avatar_hu2f5ff6798fc6a4a0636fcc8f3fed2e7b_2331574_270x270_fill_lanczos_center_3.png alt="Reza Mehrzi"></a><div class=media-body><h5 class=card-title><a href=https://rezamehrizi.github.io/>Reza Mehrzi</a></h5><h6 class=card-subtitle>Data Scientist</h6><p class=card-text>My research interests include building and developing predictive models using machine learning methods, deep learning object detection and semantic image segmentation, experimental designs, and survival analysis.</p><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href="https://scholar.google.ca/citations?user=fa3zgGAAAAAJ&amp;hl=en" target=_blank rel=noopener><i class="fas fa-graduation-cap"></i></a></li><li><a href=https://github.com/Rezamehrizi target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/reza-mehrizi/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=/uploads/resume.pdf><i class="ai ai-cv"></i></a></li></ul></div></div><div class="project-related-pages content-widget-hr"></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class="powered-by copyright-license-text">© 2023 Me. This work is licensed under <a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank>CC BY NC ND 4.0</a></p><p class="powered-by footer-license-icons"><a href=https://creativecommons.org/licenses/by-nc-nd/4.0 rel="noopener noreferrer" target=_blank aria-label="Creative Commons"><i class="fab fa-creative-commons fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-by fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nc fa-2x" aria-hidden=true></i>
<i class="fab fa-creative-commons-nd fa-2x" aria-hidden=true></i></a></p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.3322c0d94f0e691b0b24c63f4c41064b.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>